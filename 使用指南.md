# 五子棋AI深度学习模型 - 快速使用指南

## 🚀 快速开始

### 1. 环境准备

```bash
# 安装Python依赖 (如果使用PyTorch版本)
pip install torch torchvision numpy matplotlib seaborn

# 或者直接运行演示版本 (无需额外依赖)
python architecture_demo.py
```

### 2. 运行演示

```bash
# 运行完整架构演示
python architecture_demo.py

# 输出示例:
# === 五子棋AI深度学习架构演示 ===
# 总参数数量: 11,599,888
# 模型大小: 44.25 MB
# 推理速度测试完成...
```

## 📁 文件说明

### 核心实现文件

| 文件名 | 功能描述 | 是否需要PyTorch |
|--------|----------|------------------|
| `deep_learning_architecture.py` | 完整PyTorch实现 | ✅ 是 |
| `training_system.py` | 训练系统 | ✅ 是 |
| `model_benchmark.py` | 性能评估工具 | ✅ 是 |
| `architecture_demo.py` | 演示版本 | ❌ 否 |

### 文档和配置

| 文件名 | 内容 |
|--------|------|
| `深度学习模型架构设计文档.md` | 详细技术文档 |
| `完整技术方案总结.md` | 项目总结 |
| `architecture_summary.json` | 模型配置摘要 |

### 现有游戏文件

| 文件名 | 功能 |
|--------|------|
| `gomoku.py` | 五子棋游戏主程序 |
| `integrated_ai.py` | 当前AI系统 |
| `modern_ai.py` | 现代化AI |

## 🎯 使用场景

### 场景1: 了解架构设计

```bash
# 运行演示，查看架构特点
python architecture_demo.py

# 阅读详细文档
start 深度学习模型架构设计文档.md
```

### 场景2: 集成到现有项目

```python
# 在 gomoku.py 中集成新架构
from deep_learning_architecture import GomokuNetwork, ModelConfig

# 创建模型实例
config = ModelConfig(board_size=15, residual_blocks=6)
model = GomokuNetwork(config)

# 替换现有AI决策逻辑
def ai_move_with_deep_learning(board, player):
    policy_dict, value = model.predict(board, player)
    best_move = max(policy_dict.items(), key=lambda x: x[1])[0]
    return best_move
```

### 场景3: 模型训练 (需要PyTorch)

```python
from training_system import GomokuTrainer, TrainingConfig

# 配置训练参数
training_config = TrainingConfig(
    batch_size=32,
    learning_rate=1e-3,
    epochs=50,
    self_play_games=1000
)

# 开始训练
trainer = GomokuTrainer(model_config, training_config)
trainer.train()
```

### 场景4: 性能评估

```python
from model_benchmark import ModelBenchmark, BenchmarkConfig

# 配置评估
benchmark_config = BenchmarkConfig(
    num_games=50,
    inference_iterations=500
)

# 运行基准测试
benchmark = ModelBenchmark(model, benchmark_config)
results = benchmark.run_full_benchmark()
```

## 🔧 配置选项

### 模型配置 (ModelConfig)

```python
config = ModelConfig(
    board_size=15,           # 棋盘大小
    input_channels=12,       # 输入通道数
    residual_blocks=8,       # 残差块数量
    filters=256,             # 特征通道数
    use_attention=True,      # 使用注意力机制
    use_multiscale=True,     # 使用多尺度特征
    pattern_channels=32,     # 棋型检测通道
    dropout_rate=0.3         # Dropout比率
)
```

### 训练配置 (TrainingConfig)

```python
config = TrainingConfig(
    batch_size=64,           # 批次大小
    learning_rate=1e-3,      # 学习率
    epochs=100,              # 训练轮数
    self_play_games=1000,    # 自对弈局数
    evaluation_games=100,    # 评估游戏数
    mixed_precision=True,    # 混合精度训练
    save_frequency=10        # 保存频率
)
```

## 💡 技术特点

### 🧠 智能特性

- **双头网络**: 策略 + 价值同时预测
- **注意力机制**: 聚焦关键决策区域
- **棋型检测**: 专门识别五子棋模式
- **对称性增强**: 利用棋盘对称性

### ⚡ 性能特性

- **1160万参数**: 平衡性能与效率
- **44MB模型**: 适中的存储需求
- **混合精度**: 加速训练推理
- **分布式支持**: 多GPU训练

### 🎯 五子棋专用

- **四方向检测**: 水平、垂直、对角线
- **位置编码**: 理解空间关系
- **历史特征**: 考虑移动序列
- **中心偏向**: 突出重要区域

## 📊 预期性能

### 计算性能
- **推理速度**: 100+ FPS (GPU)
- **训练时间**: 约1周完整训练
- **内存需求**: 12GB GPU + 32GB RAM

### 棋力水平
- **目标ELO**: 2000+ (业余高手)
- **专家一致性**: 60%+ 
- **决策深度**: 等效15-20步

## 🔍 调试技巧

### 检查模型输出

```python
# 验证输出形状
state = np.zeros((15, 15))
policy, value = model.predict(state, 1)

print(f"策略概率数量: {len(policy)}")
print(f"概率总和: {sum(policy.values()):.3f}")  # 应该接近1.0
print(f"价值范围: {value:.3f}")  # 应该在[-1, 1]之间
```

### 检查训练进度

```python
# 监控损失函数
training_stats = trainer.train()
print(f"最终损失: {training_stats['loss_history'][-1]['total_loss']:.4f}")

# 检查评估结果
if training_stats['evaluation_history']:
    latest_eval = training_stats['evaluation_history'][-1]
    print(f"最新胜率: {latest_eval['win_rate']:.3f}")
```

## 🛠️ 故障排除

### 常见问题

1. **PyTorch未安装**
   ```bash
   pip install torch torchvision
   ```

2. **内存不足**
   - 减少batch_size
   - 减少residual_blocks
   - 使用混合精度训练

3. **训练收敛慢**
   - 增加自对弈数据量
   - 调整学习率
   - 使用课程学习

4. **推理速度慢**
   - 启用模型优化
   - 使用GPU推理
   - 考虑模型量化

### 性能优化

```python
# 优化推理速度
model.eval()  # 切换到评估模式
torch.jit.script(model)  # JIT编译

# 优化内存使用
torch.cuda.empty_cache()  # 清理GPU缓存
```

## 📈 进阶使用

### 自定义网络架构

```python
# 创建轻量级版本
light_config = ModelConfig(
    residual_blocks=4,
    filters=128,
    pattern_channels=16
)

# 创建重型版本  
heavy_config = ModelConfig(
    residual_blocks=16,
    filters=512,
    pattern_channels=64
)
```

### 集成现有系统

```python
# 在 integrated_ai.py 中添加深度学习支持
class EnhancedAI:
    def __init__(self):
        self.deep_model = GomokuNetwork(config)
        self.traditional_ai = IntegratedGomokuAI()
    
    def get_move(self, board, player):
        # 结合深度学习和传统AI
        dl_move = self.deep_model.predict(board, player)
        traditional_move = self.traditional_ai.get_move(board, player)
        
        # 决策融合逻辑
        return self.combine_decisions(dl_move, traditional_move)
```

## 🎯 下一步计划

1. **运行演示**: `python architecture_demo.py`
2. **阅读文档**: 了解详细技术原理
3. **安装PyTorch**: 准备完整训练环境
4. **开始训练**: 生成第一个深度学习模型
5. **性能评估**: 对比传统AI性能
6. **集成部署**: 整合到现有游戏中

---

**问题反馈**: 如有技术问题，请参考详细文档或检查代码注释。

**技术支持**: 本项目提供完整的代码实现和详细文档，支持从入门到专业级的使用需求。